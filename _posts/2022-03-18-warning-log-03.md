---
title: ì—ëŸ¬í•´ê²° Log) java.lang.IllegalStateException ì‘ë‹µì´ ì´ë¯¸ ì»¤ë°‹ëœ í›„ì—ëŠ” sendRedirect()ë¥¼ í˜¸ì¶œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
toc: true
toc_sticky: true
toc_label: ëª©ì°¨
published: true
categories:
    - ErrorLog
tags:
    - Error
    - Solve
    - Log
---
# ì‚¬ìš©í™˜ê²½
* MacBook Air (M1, 2020) 16GB
* JDK 8
* Eclipse 2021-12
* tomcat 8.5<br><br><br>

# ì—ëŸ¬ì˜ ë°œìƒ
* í˜„ì¬ `MVC Model2` íŒ¨í„´ì„ ì ìš©í•œ ì›¹ ì‚¬ì´íŠ¸ë¥¼ ë§Œë“œëŠ” í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰ì¤‘ì´ë‹¤.
* í˜ì´ì§€ ì´ë™ ìš”ì²­ì´ ë“¤ì–´ì™”ì„ ë•Œ `front`ì—ì„œ ì´ë™í•  í˜ì´ì§€ë¥¼ ë§¤í•‘í•œ ë‹¤ìŒ ì„œë¸”ë¦¿ì—ì„œ í•„ìš”í•œ ì•¡ì…˜ë“¤ì„ ì²˜ë¦¬í•œ í›„ ìµœì¢… ëª©ì ì§€ë¡œ ì´ë™í•˜ê²Œ ëœë‹¤.
* ë‚˜ëŠ” `ë§ˆì´í˜ì´ì§€` ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ê³  ìˆì—ˆëŠ”ë°, ë¡œê·¸ì¸ í›„ ë§ˆì´í˜ì´ì§€ì— ì…ì¥í•˜ë ¤ë©´ ë¹„ë°€ë²ˆí˜¸ë¥¼ í•œ ë²ˆ ë” ì…ë ¥í•œ í›„ ì¼ì¹˜í•˜ë©´ íšŒì› ì •ë³´ë¥¼ ìˆ˜ì •í•  ìˆ˜ ìˆëŠ” í˜ì´ì§€ë¡œ ì´ë™í•˜ê³  ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ë‹¤ëŠ” ì•Œë¦¼ì°½ì„ ë„ìš°ê³  ì‹¶ì—ˆë‹¤.
* ê·¸ë˜ì„œ `JAVA` ì½”ë“œì—ì„œ `JavaScript` ì½”ë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆì–´ì•¼ í–ˆë‹¤.
* ê·¸ë¦¬í•˜ì—¬ ì²˜ìŒì— ì‹œë„í–ˆë˜ ëª¨ë¸... ğŸ‘‡

## MemberFrontConroller.java

```java
import java.io.IOException;

import javax.servlet.RequestDispatcher;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import com.project.cafe.api.sms.SmsService;

public class MemberFrontController extends HttpServlet
{
    protected void doProcess(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException
    {
        // 1. ì „ë‹¬ë˜ëŠ” ê°€ìƒì£¼ì†Œ ê³„ì‚°
        // ë§¤í•‘ëœ(.meë¡œ ëë‚˜ëŠ”) ì£¼ì†Œë¥¼ ë°›ì•„ì˜´
        String requestURI = req.getRequestURI();
        System.out.println("requestURI : " + requestURI);

        // ë§¤í•‘ëœ í•´ë‹¹ í”„ë¡œì íŠ¸ ì£¼ì†Œë¥¼ êµ¬í•¨
        String ctxPath = req.getContextPath();
        System.out.println("ctxPath : " + ctxPath);

        // ë§¤í•‘ëœ ì£¼ì†Œ - í”„ë¡œì íŠ¸ ì£¼ì†Œ = ê³„ì† ë°”ë€” ë’·ìë¦¬ ì£¼ì†Œ êµ¬í•¨
        String command = requestURI.substring(ctxPath.length());
        System.out.println("command : " + command);

        System.out.println("C : ê°€ìƒì£¼ì†Œ ê³„ì‚° ì™„ë£Œ\n");
        // 1. ì „ë‹¬ë˜ëŠ” ê°€ìƒì£¼ì†Œ ê³„ì‚°


        // 2. ê°€ìƒì£¼ì†Œ ë§¤í•‘
        Action action = null;
        ActionForward forward = null;

        if (command.equals("/MemberJoinAction.me"))
        {
            System.out.println("C : /MemberJoinAction.me í˜¸ì¶œ");
            System.out.println("C : ì´ì „ í˜ì´ì§€ ì •ë³´ë¥¼ ê°€ì ¸ì™€ì„œ DB í…Œì´ë¸”ì— ì €ì¥ í›„ í˜ì´ì§€ ì´ë™");

            action = new MemberJoinAction(); // ì¸í„°í˜ì´ìŠ¤ë¥¼ í†µí•´ ê°ì²´ë¥¼ ìƒì„±í•¨ìœ¼ë¡œì¨ ì•½í•œê²°í•©ì´ ë˜ë„ë¡ í•œë‹¤.

            try
            {
                forward = action.execute(req, resp);
            }
            catch (Exception e)
            {
                e.printStackTrace();
            }
        }
        else if (command.equals("/memberUpdateAction.me"))
        {
            System.out.println("C : /memberUpdateAction.me í˜¸ì¶œ");

            action = new MemberUpdateAction();

            try {
                forward = action.execute(req, resp);
            }
            catch (Exception e) {
                e.printStackTrace();
            }
        }
        else if (command.equals("/CheckPassAction.me"))
        {
            System.out.println("C : /CheckPassAction.me í˜¸ì¶œ");

            action = new CheckPassAction();

            try {
                forward = action.execute(req, resp);
            }
            catch (Exception e) {
                e.printStackTrace();
            }
        }
        else
        {
            forward = new ActionForward();

            if (command.equals("/main.me"))
            {
                System.out.println("C : ë©”ì¸í˜ì´ì§€ í˜¸ì¶œ");
                forward.setPath("./main/main.jsp");
            }
            else if (command.equals("/join.me"))
            {
                System.out.println("C : íšŒì›ê°€ì… í˜ì´ì§€ í˜¸ì¶œ");
                forward.setPath("./member/join.jsp");
            }
            else if (command.equals("/login.me"))
            {
                System.out.println("C : ë¡œê·¸ì¸ í˜ì´ì§€ í˜¸ì¶œ");
                forward.setPath("./member/login.jsp");
            }
            else if (command.equals("/logout.me"))
            {
                System.out.println("C : ë¡œê·¸ì•„ì›ƒ í˜ì´ì§€ í˜¸ì¶œ");
                forward.setPath("/logout.me");
            }
            else if (command.equals("/checkPass.me"))
            {
                System.out.println("C : ë¹„ë²ˆ í•œ ë²ˆ ë” ì…ë ¥í•˜ëŠ” í˜ì´ì§€ í˜¸ì¶œ");
                forward.setPath("./member/checkPass.jsp");
            }
            else if (command.equals("/myPage.me"))
            {
                System.out.println("C : ë§ˆì´í˜ì´ì§€ í˜¸ì¶œ");
                forward.setPath("./member/myPage.jsp");
            }

            forward.setRedirect(false);
        }

        System.out.println("C : ê°€ìƒì£¼ì†Œ ë§¤í•‘ ì™„ë£Œ\n");
        // 2. ê°€ìƒì£¼ì†Œ ë§¤í•‘


        // 3. í˜ì´ì§€ ì´ë™
        if (null != forward) // í˜ì´ì§€ ì´ë™ì •ë³´ê°€ ìˆì„ ë•Œ
        {
            if (forward.isRedirect())
            {
                System.out.println("C : sendRedirect ë°©ì‹ - " + forward.getPath() + " ì´ë™");
                resp.sendRedirect(forward.getPath());
            }
            else
            {
                System.out.println("C : forward ë°©ì‹ - " + forward.getPath() + " ì´ë™");
                RequestDispatcher dis = req.getRequestDispatcher(forward.getPath());
                dis.forward(req, resp);
            }

            System.out.println("C : í˜ì´ì§€ ì´ë™ ì™„ë£Œ");
        }
        // 3. í˜ì´ì§€ ì´ë™
    }

    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException
    {
        doProcess(req, resp);
    }

    @Override
    protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException
    {
        doProcess(req, resp);
    }
}
```

* ì´ë™í•˜ê³ ì í•˜ëŠ” í˜ì´ì§€ë¡œ ë§¤í•‘í•´ ì£¼ëŠ” `front`

## CheckPassAction.java

```java
import java.io.PrintWriter;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import com.project.cafe.member.db.MemberDAO;
import com.project.cafe.member.db.MemberDTO;

public class CheckPassAction implements Action
{
    @Override
    public ActionForward execute(HttpServletRequest request, HttpServletResponse response) throws Exception
    {
        System.out.println("M : CheckPassAction - execute() í˜¸ì¶œ");

        // íŒŒë¼ë©”í„° ì €ì¥
        String id = request.getParameter("id");
        String pass = request.getParameter("pass");

        // íšŒì›ì •ë³´ ì €ì¥
        MemberDTO dto = new MemberDTO();
        dto.setId(id);
        dto.setPass(pass);

        response.setContentType("text/html; charset=utf-8");
        PrintWriter out = response.getWriter();
        ActionForward forward = new ActionForward();

        // DB ì—°ë™í•´ì„œ ì•„ì´ë””ì™€ ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ëŠ” ì§€ í™•ì¸
        MemberDAO dao = new MemberDAO();
        int result = dao.loginCheck(dto);
        if (1 == result)
        {
            // ë¹„ë²ˆ ì¼ì¹˜
            forward.setPath("./myPage.me");
        }
        else
        {
            // ë¹„ë²ˆ ë¶ˆì¼ì¹˜
            out.println("<script>alert('ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤!');</script>");
            forward.setPath("./checkPass.me");
        }

        forward.setRedirect(true);
        out.close();

        return forward;
    }
}
```

* `front`ì˜ í˜ì´ì§€ ë§¤í•‘ í˜•íƒœê°€ `forward` í˜•ì‹ì´ê¸° ë•Œë¬¸ì— `Action` í´ë˜ìŠ¤ì—ì„œ DB ì—°ë™ ë™ì‘ì„ ì²˜ë¦¬í•œ í›„ ì´ë™í•  í˜ì´ì§€ ì •ë³´ë¥¼ `front`ë¡œ ë¦¬í„´í•´ì„œ ì´ë™í•˜ëŠ” í˜•ì‹ì„ ì·¨í–ˆë‹¤.
* ê·¸ëŸ°ë° ì´ë ‡ê²Œ ì‹¤í–‰í•˜ë‹ˆê¹Œ ë™ì‘ì´ ì œëŒ€ë¡œ ì•ˆ ë¨...<br>
 
* java.lang.IllegalStateException: ì‘ë‹µì´ ì´ë¯¸ ì»¤ë°‹ëœ í›„ì—ëŠ”, sendRedirect()ë¥¼ í˜¸ì¶œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.<br>

* ğŸ‘† ì´ëŸ° ì—ëŸ¬ ë©”ì‹œì§€ê°€ ë‚˜ì˜¤ë©° ì´ë™ì´ ì œëŒ€ë¡œ ë˜ì§ˆ ì•Šì•˜ë‹¤ ã… .ã… 
* ê·¸ë˜ì„œ ì˜¤ëŠ˜ í•™ì› ì™€ì„œ ì„ ìƒë‹˜í•œí…Œ ì—¬ì­¤ë³´ë‹ˆê¹Œ ìë°” ì½”ë“œì™€ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì½”ë“œë¥¼ í•¨ê»˜ ì¼ì„ ë•Œì—” ìë°”ìŠ¤í¬ë¦½íŠ¸ ì½”ë“œê°€ ê°€ì¥ ë‚˜ì¤‘ì— ì‹¤í–‰ë˜ê¸° ë•Œë¬¸ì— ìœ„ì™€ ê°™ì€ í˜•íƒœë¡œ ì“°ë©´ ìë°” ì½”ë“œê°€ ë¨¼ì € ì‹¤í–‰ ë˜ë©´ì„œ ìë°”ìŠ¤í¬ë¦½íŠ¸ê°€ ì•Œë¦¼ì°½ì„ ë„ìš°ê¸° ì „ì— ì´ë¯¸ ë‹¤ë¥¸ í˜ì´ì§€ë¡œ ì´ë™í•œ ìƒíƒœê°€ ë˜ëŠ” ê²ƒì´ì—ˆë‹¤.
* ê·¸ë˜ì„œ ì´ë¯¸ ì´ë™í•œ ìƒíƒœì—ì„œ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì½”ë“œë¡œ ì•Œë¦¼ì°½ì„ ë„ìš°ë ¤ í•˜ë‹ˆ ì¶©ëŒì´ ìƒê²¨ì„œ ì œëŒ€ë¡œ ë™ì‘í•˜ì§€ ì•ŠëŠ” ê²ƒì´ì—ˆë‹¤. ì»¤ë°‹ì´ ë˜ì—ˆë‹¤ëŠ” ëœ»ì´ ì´ëŸ¬í•œ ì˜ë¯¸ì˜€ë‹¤.<br><br>

# ë¬¸ì œ í•´ê²°
* ê·¸ë˜ì„œ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì½”ë“œë¡œ í˜ì´ì§€ë¥¼ ì´ë™í•˜ë„ë¡ ìˆ˜ì •í–ˆë‹¤.

## CheckPassAction.java

```java
import java.io.PrintWriter;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import com.project.cafe.member.db.MemberDAO;
import com.project.cafe.member.db.MemberDTO;

public class CheckPassAction implements Action 
{
	@Override
	public ActionForward execute(HttpServletRequest request, HttpServletResponse response) throws Exception 
	{
		System.out.println("M : CheckPassAction - execute() í˜¸ì¶œ");
		
		// íŒŒë¼ë©”í„° ì €ì¥
		String id = request.getParameter("id");
		String pass = request.getParameter("pass");
		
		// íšŒì›ì •ë³´ ì €ì¥
		MemberDTO dto = new MemberDTO();
		dto.setId(id);
		dto.setPass(pass);
		
		response.setContentType("text/html; charset=utf-8");
		PrintWriter out = response.getWriter();
		
		// DB ì—°ë™í•´ì„œ ì•„ì´ë””ì™€ ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ëŠ” ì§€ í™•ì¸
		MemberDAO dao = new MemberDAO();
		int result = dao.loginCheck(dto);
		if (1 == result)
		{
			// ë¹„ë²ˆ ì¼ì¹˜
			out.println("<script>location.href='./myPage.me';</script>");
		}
		else 
		{
			// ë¹„ë²ˆ ë¶ˆì¼ì¹˜
			out.println("<script>alert('ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤!'); history.back();</script>");
		}
		
		out.close();
		
		return null;
	}
}
```

* ìë°”ìŠ¤í¬ë¦½íŠ¸ ì½”ë“œë¡œ í˜ì´ì§€ ì´ë™ì´ ì´ë£¨ì–´ì§€ë„ë¡ í•˜ê¸° ìœ„í•´ì„œ í˜ì´ì§€ ì´ë™ ì •ë³´ë¥¼ ë‹´ì€ ê°ì²´ë¥¼ ë§Œë“¤ì§€ ì•Šê³  `null`ì„ ë¦¬í„´í–ˆë‹¤.
* ì–´ì œ í•œ ì‹œê°„ ë„˜ê²Œ ê³ ë¯¼í–ˆëŠ”ë° í•™ì› ì„ ìƒë‹˜í•œí…Œ ì—¬ì­¤ë³´ë‹ˆê¹Œ 5ë¶„ë§Œì— í•´ê²° ë˜ì—ˆë‹¤. ğŸ˜…

<p align="center"><img src="../../assets/images/checkPassAction.png" width="400"></p>

* ê³ ë¯¼ ë! ìˆ˜ì • ì™„ë£Œ!!
